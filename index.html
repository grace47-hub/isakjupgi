<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1-8 ì´ì‚­ì¤ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            min-height: 100vh;
        }

        .home-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 48px;
            color: #1f2937;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.025em;
        }

        .header p {
            font-size: 1.125rem;
            color: #6b7280;
            font-weight: 400;
        }

        .category-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            max-width: 800px;
            width: 100%;
        }

        .category-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 32px 24px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #e5e7eb;
            position: relative;
            overflow: hidden;
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: #3b82f6;
            transform: scaleY(0);
            transition: transform 0.2s ease;
        }

        .category-card:hover::before {
            transform: scaleY(1);
        }

        .category-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            border-color: #3b82f6;
        }

        .category-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .category-icon {
            width: 48px;
            height: 48px;
            background: #f8fafc;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 16px;
            font-size: 1.5rem;
            transition: all 0.2s ease;
        }

        .category-card:hover .category-icon {
            background: #3b82f6;
            color: white;
        }

        .category-card h2 {
            font-size: 1.25rem;
            color: #1f2937;
            margin: 0;
            font-weight: 600;
        }

        .category-card p {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.5;
            margin: 0;
        }

        .category-arrow {
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            color: #9ca3af;
            transition: all 0.2s ease;
        }

        .category-card:hover .category-arrow {
            color: #3b82f6;
            transform: translateY(-50%) translateX(4px);
        }

        .footer {
            margin-top: 48px;
            color: #9ca3af;
            text-align: center;
            font-size: 0.875rem;
        }

        /* í˜ì´ì§€ ì»¨í…Œì´ë„ˆ */
        .page-container {
            display: none;
            width: 100%;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #f8fafc;
            z-index: 1000;
            overflow-y: auto;
        }

        .page-container.active {
            display: block;
        }

        /* ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */
        .navbar {
            background: #ffffff;
            border-bottom: 1px solid #e5e7eb;
            padding: 16px 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-left {
            display: flex;
            align-items: center;
        }

        .home-btn {
            background: none;
            border: none;
            color: #6b7280;
            font-size: 1.5rem;
            cursor: pointer;
            margin-right: 16px;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .home-btn:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .page-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
        }

        .upload-btn, .add-event-btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .upload-btn:hover, .add-event-btn:hover {
            background: #2563eb;
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px 24px;
        }

        /* ê²€ìƒ‰ ë° í•„í„° ì˜ì—­ */
        .filter-section {
            background: #ffffff;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid #e5e7eb;
        }

        .search-container {
            margin-bottom: 24px;
        }

        .search-input {
            width: 100%;
            max-width: 400px;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .filter-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            align-items: center;
        }

        .sort-buttons {
            display: flex;
            gap: 8px;
        }

        .sort-btn {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            background: #ffffff;
            color: #374151;
            border-radius: 6px;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .sort-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .sort-btn:hover:not(.active) {
            background: #f9fafb;
            border-color: #9ca3af;
        }

        .subject-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .subject-btn {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            background: #ffffff;
            color: #6b7280;
            border-radius: 20px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .subject-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .subject-btn:hover:not(.active) {
            background: #f9fafb;
            border-color: #9ca3af;
        }

        /* ìë£Œ ëª©ë¡ */
        .materials-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .material-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            transition: all 0.2s ease;
        }

        .material-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            border-color: #3b82f6;
        }

        .material-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .material-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .material-subject {
            background: #f3f4f6;
            color: #374151;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .delete-btn {
            background: none;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
            opacity: 0.6;
        }

        .delete-btn:hover {
            background: #fee2e2;
            opacity: 1;
            transform: scale(1.1);
        }

        .edit-btn {
            background: none;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
            opacity: 0.6;
        }

        .edit-btn:hover {
            background: #e0f2fe;
            opacity: 1;
            transform: scale(1.1);
        }

        .material-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .material-description {
            color: #4b5563;
            font-size: 0.875rem;
            line-height: 1.5;
            margin-bottom: 16px;
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
            border-left: 3px solid #e5e7eb;
        }

        .material-files {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }

        .file-tag {
            background: #eff6ff;
            color: #1d4ed8;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .file-tag:hover {
            background: #dbeafe;
        }

        /* ì¢‹ì•„ìš” ë° ëŒ“ê¸€ ì„¹ì…˜ */
        .material-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-top: 12px;
            border-top: 1px solid #e5e7eb;
        }

        .like-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .like-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            background: none;
            border: 1px solid #d1d5db;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .like-btn:hover {
            background: #f9fafb;
            border-color: #3b82f6;
        }

        .like-btn.liked {
            background: #eff6ff;
            border-color: #3b82f6;
            color: #3b82f6;
        }

        .comment-toggle {
            background: none;
            border: none;
            color: #6b7280;
            cursor: pointer;
            font-size: 0.875rem;
            padding: 6px 12px;
            border-radius: 20px;
            transition: all 0.2s ease;
        }

        .comment-toggle:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .material-date {
            font-size: 0.75rem;
            color: #9ca3af;
            text-align: right;
        }

        /* ëŒ“ê¸€ ì„¹ì…˜ */
        .comments-section {
            display: none;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #e5e7eb;
        }

        .comments-section.active {
            display: block;
        }

        .comment-form {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
        }

        .comment-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            font-size: 0.875rem;
            outline: none;
        }

        .comment-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .comment-submit {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .comment-submit:hover {
            background: #2563eb;
        }

        .comments-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .comment-item {
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .comment-author {
            font-weight: 500;
            color: #374151;
            font-size: 0.875rem;
        }

        .comment-date {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .comment-content {
            color: #4b5563;
            font-size: 0.875rem;
            line-height: 1.4;
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            padding: 4px;
        }

        .close-btn:hover {
            color: #374151;
        }

        /* í¼ ìŠ¤íƒ€ì¼ */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
        }

        .form-label.required::after {
            content: ' *';
            color: #ef4444;
            font-weight: bold;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.875rem;
            transition: all 0.2s ease;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-input.error, .form-select.error {
            border-color: #ef4444;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        .error-message {
            color: #ef4444;
            font-size: 0.75rem;
            margin-top: 4px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .file-upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 6px;
            padding: 40px 20px;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .file-upload-area:hover {
            border-color: #3b82f6;
            background: #f8fafc;
        }

        .file-upload-area.dragover {
            border-color: #3b82f6;
            background: #eff6ff;
        }

        .upload-icon {
            font-size: 3rem;
            color: #9ca3af;
            margin-bottom: 16px;
        }

        .upload-text {
            color: #6b7280;
            margin-bottom: 8px;
        }

        .upload-hint {
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .selected-files {
            margin-top: 16px;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #f9fafb;
            border-radius: 6px;
            margin-bottom: 8px;
        }

        .file-info {
            display: flex;
            align-items: center;
        }

        .file-icon {
            margin-right: 8px;
            font-size: 1.2rem;
        }

        .remove-file {
            background: none;
            border: none;
            color: #ef4444;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 4px;
        }

        .remove-file:hover {
            color: #dc2626;
        }

        .form-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
        }

        .btn-cancel {
            padding: 10px 20px;
            border: 1px solid #d1d5db;
            background: white;
            color: #374151;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .btn-cancel:hover {
            background: #f9fafb;
        }

        .btn-submit {
            padding: 10px 20px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .btn-submit:hover {
            background: #2563eb;
        }

        /* ìº˜ë¦°ë” ìŠ¤íƒ€ì¼ */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding: 0 8px;
        }

        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .nav-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6b7280;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .nav-btn:hover {
            background: #f3f4f6;
            color: #374151;
        }

        .current-month {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            min-width: 200px;
            text-align: center;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }

        .calendar-day-header {
            background: #f9fafb;
            padding: 12px 8px;
            text-align: center;
            font-weight: 500;
            color: #6b7280;
            font-size: 0.875rem;
        }

        .calendar-day {
            background: white;
            min-height: 120px;
            padding: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .calendar-day:hover {
            background: #f8fafc;
        }

        .calendar-day.other-month {
            background: #f9fafb;
            color: #9ca3af;
        }

        .calendar-day.today {
            background: #eff6ff;
        }

        .day-number {
            font-weight: 500;
            color: #374151;
            margin-bottom: 4px;
        }

        .calendar-day.other-month .day-number {
            color: #9ca3af;
        }

        .calendar-day.today .day-number {
            color: #1d4ed8;
            font-weight: 600;
        }

        .event-item {
            background: #3b82f6;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-bottom: 2px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .event-item:hover {
            background: #2563eb;
        }

        .event-item.school {
            background: #10b981;
        }

        .event-item.exam {
            background: #f59e0b;
        }

        .event-item.holiday {
            background: #ef4444;
        }

        .event-item.class {
            background: #8b5cf6;
        }

        .event-item.long-pressed {
            position: relative;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 10;
        }

        .event-delete-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            cursor: pointer;
            z-index: 11;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            animation: deleteButtonPop 0.2s ease-out;
        }

        .event-delete-btn:hover {
            background: #dc2626;
            transform: scale(1.1);
        }

        @keyframes deleteButtonPop {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* ê¸¸ê²Œ ëˆ„ë¥´ê¸° ì‹œê°ì  í”¼ë“œë°± */
        .event-item {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        /* ë™ê¸°í™” ìƒíƒœ í‘œì‹œ */
        .sync-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 3000;
        }

        .sync-status.show {
            opacity: 1;
            transform: translateY(0);
        }

        .sync-status.error {
            background: #ef4444;
        }

        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .home-page {
                padding: 24px 16px;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .category-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .category-card {
                padding: 30px 20px;
            }

            .nav-container {
                padding: 0 16px;
            }

            .main-container {
                padding: 24px 16px;
            }

            .filter-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .materials-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .subject-filter {
                justify-content: center;
            }

            .modal-content {
                padding: 24px;
                margin: 16px;
            }

            .calendar-grid {
                font-size: 0.875rem;
            }

            .calendar-day {
                min-height: 100px;
                padding: 6px;
            }

            .current-month {
                font-size: 1.25rem;
                min-width: 150px;
            }

            .comment-form {
                flex-direction: column;
                gap: 8px;
            }

            .comment-input {
                border-radius: 6px;
            }

            .comment-submit {
                border-radius: 6px;
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <!-- ë™ê¸°í™” ìƒíƒœ í‘œì‹œ -->
    <div id="syncStatus" class="sync-status">
        <span id="syncText">ë°ì´í„° ë™ê¸°í™”ë¨</span>
    </div>

    <!-- í™ˆí˜ì´ì§€ -->
    <div id="homePage" class="home-page">
        <header class="header">
            <h1>1-8 ì´ì‚­ì¤ê¸°</h1>
            <p>í•¨ê»˜ ë°°ìš°ê³  ì„±ì¥í•˜ëŠ” ìš°ë¦¬ ë°˜</p>
        </header>

        <main class="category-container">
            <div class="category-card" onclick="navigateToPage('learning')">
                <div class="category-header">
                    <div class="category-icon">ğŸ“š</div>
                    <h2>í•™ìŠµìë£Œ</h2>
                </div>
                <p>ê³¼ëª©ë³„ í•™ìŠµìë£Œì™€ ë¯¸ë””ì–´ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê³  ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                <div class="category-arrow">â†’</div>
            </div>

            <div class="category-card" onclick="navigateToPage('schedule')">
                <div class="category-header">
                    <div class="category-icon">ğŸ“…</div>
                    <h2>í•™ì‚¬ì¼ì •</h2>
                </div>
                <p>ì¤‘ìš”í•œ í•™ì‚¬ì¼ì •ê³¼ ë°˜ í–‰ì‚¬ ì¼ì •ì„ í™•ì¸í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                <div class="category-arrow">â†’</div>
            </div>
        </main>

        <footer class="footer">
            <p>Â© 2025 1-8 ì´ì‚­ì¤ê¸° | ëª¨ë“  í•™ìƒì´ í•¨ê»˜ ë§Œë“¤ì–´ê°€ëŠ” ê³µê°„</p>
        </footer>
    </div>

    <!-- í•™ìŠµìë£Œ í˜ì´ì§€ -->
    <div id="learningPage" class="page-container">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-left">
                    <button class="home-btn" onclick="navigateToPage('home')">â†</button>
                    <span class="page-title">í•™ìŠµìë£Œ</span>
                </div>
                <button class="upload-btn" onclick="openUploadModal()">+ ìƒˆ ìë£Œ ì—…ë¡œë“œ</button>
            </div>
        </nav>

        <div class="main-container">
            <div class="filter-section">
                <div class="search-container">
                    <input type="text" class="search-input" placeholder="í‚¤ì›Œë“œë¡œ ê²€ìƒ‰..." onkeyup="searchMaterials(this.value)">
                </div>

                <div class="filter-controls">
                    <div class="sort-buttons">
                        <button class="sort-btn active" onclick="sortBy('latest')">ìµœì‹ ìˆœ</button>
                        <button class="sort-btn" onclick="sortBy('subject')">ê³¼ëª©ë³„</button>
                        <button class="sort-btn" onclick="sortBy('popular')">ì¸ê¸°ìˆœ</button>
                    </div>

                    <div class="subject-filter">
                        <button class="subject-btn active" onclick="filterBySubject('all')">ì „ì²´</button>
                        <button class="subject-btn" onclick="filterBySubject('êµ­ì–´')">êµ­ì–´</button>
                        <button class="subject-btn" onclick="filterBySubject('ì˜ì–´')">ì˜ì–´</button>
                        <button class="subject-btn" onclick="filterBySubject('ìˆ˜í•™')">ìˆ˜í•™</button>
                        <button class="subject-btn" onclick="filterBySubject('ê³¼í•™')">ê³¼í•™</button>
                        <button class="subject-btn" onclick="filterBySubject('ì‚¬íšŒ')">ì‚¬íšŒ</button>
                        <button class="subject-btn" onclick="filterBySubject('ì •ë³´')">ì •ë³´</button>
                        <button class="subject-btn" onclick="filterBySubject('í•œì')">í•œì</button>
                        <button class="subject-btn" onclick="filterBySubject('ê³¼íƒì‹¤')">ê³¼íƒì‹¤</button>
                        <button class="subject-btn" onclick="filterBySubject('ì² í•™')">ì² í•™</button>
                        <button class="subject-btn" onclick="filterBySubject('ë…¼ìˆ ')">ë…¼ìˆ </button>
                        <button class="subject-btn" onclick="filterBySubject('ìŒì•…')">ìŒì•…</button>
                        <button class="subject-btn" onclick="filterBySubject('í•œêµ­ì‚¬')">í•œêµ­ì‚¬</button>
                        <button class="subject-btn" onclick="filterBySubject('ì²´ìœ¡')">ì²´ìœ¡</button>
                        <button class="subject-btn" onclick="filterBySubject('ë³´ê±´')">ë³´ê±´</button>
                    </div>
                </div>
            </div>

            <div class="materials-grid" id="materialsGrid">
                <!-- ê¸°ë³¸ ìƒ˜í”Œ ìë£Œë“¤ -->
            </div>
        </div>
    </div>

    <!-- í•™ì‚¬ì¼ì • í˜ì´ì§€ -->
    <div id="schedulePage" class="page-container">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-left">
                    <button class="home-btn" onclick="navigateToPage('home')">â†</button>
                    <span class="page-title">í•™ì‚¬ì¼ì •</span>
                </div>
                <button class="add-event-btn" onclick="openEventModal()">+ ì¼ì • ì¶”ê°€</button>
            </div>
        </nav>

        <div class="main-container">
            <div class="calendar-header">
                <div class="calendar-nav">
                    <button class="nav-btn" onclick="changeMonth(-1)">â€¹</button>
                    <div class="current-month" id="currentMonth"></div>
                    <button class="nav-btn" onclick="changeMonth(1)">â€º</button>
                </div>
            </div>

            <div class="calendar-grid" id="calendarGrid">
                <!-- ìº˜ë¦°ë”ê°€ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <!-- íŒŒì¼ ì—…ë¡œë“œ ëª¨ë‹¬ -->
    <div id="uploadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ìƒˆ ìë£Œ ì—…ë¡œë“œ</h2>
                <button class="close-btn" onclick="closeUploadModal()">&times;</button>
            </div>

            <form id="uploadForm">
                <div class="form-group">
                    <label class="form-label">ì œëª© *</label>
                    <input type="text" class="form-input" id="materialTitle" required>
                </div>

                <div class="form-group">
                    <label class="form-label">ì‘ì„±ì *</label>
                    <input type="text" class="form-input" id="materialAuthor" required>
                </div>

                <div class="form-group">
                    <label class="form-label">ê³¼ëª© *</label>
                    <select class="form-select" id="materialSubject" required>
                        <option value="">ê³¼ëª©ì„ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="êµ­ì–´">êµ­ì–´</option>
                        <option value="ì˜ì–´">ì˜ì–´</option>
                        <option value="ìˆ˜í•™">ìˆ˜í•™</option>
                        <option value="ê³¼í•™">ê³¼í•™</option>
                        <option value="ì‚¬íšŒ">ì‚¬íšŒ</option>
                        <option value="ì •ë³´">ì •ë³´</option>
                        <option value="í•œì">í•œì</option>
                        <option value="ê³¼íƒì‹¤">ê³¼íƒì‹¤</option>
                        <option value="ì² í•™">ì² í•™</option>
                        <option value="ë…¼ìˆ ">ë…¼ìˆ </option>
                        <option value="ìŒì•…">ìŒì•…</option>
                        <option value="í•œêµ­ì‚¬">í•œêµ­ì‚¬</option>
                        <option value="ì²´ìœ¡">ì²´ìœ¡</option>
                        <option value="ë³´ê±´">ë³´ê±´</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">ì„¤ëª…</label>
                    <textarea class="form-textarea" id="materialDescription" placeholder="ìë£Œì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">íŒŒì¼ ì²¨ë¶€</label>
                    <div class="file-upload-area" id="fileUploadArea" onclick="document.getElementById('fileInput').click()">
                        <div class="upload-icon">ğŸ“</div>
                        <div class="upload-text">íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ì—¬ê¸°ë¡œ ë“œë˜ê·¸í•˜ì„¸ìš”</div>
                        <div class="upload-hint">PDF, ì´ë¯¸ì§€, ë™ì˜ìƒ, ë¬¸ì„œ íŒŒì¼ ë“±ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</div>
                    </div>
                    <input type="file" id="fileInput" multiple style="display: none;">
                    <div id="selectedFiles" class="selected-files"></div>
                </div>

                <div class="form-buttons">
                    <button type="button" class="btn-cancel" onclick="closeUploadModal()">ì·¨ì†Œ</button>
                    <button type="submit" class="btn-submit" id="uploadSubmitBtn">ì—…ë¡œë“œ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ì¼ì • ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ì¼ì • ì¶”ê°€</h2>
                <button class="close-btn" onclick="closeEventModal()">&times;</button>
            </div>

            <form id="eventForm">
                <div class="form-group">
                    <label class="form-label required">ì¼ì • ì œëª©</label>
                    <input type="text" class="form-input" id="eventTitle" required placeholder="ì˜ˆ: ì¤‘ê°„ê³ ì‚¬, ì²´ìœ¡ëŒ€íšŒ, ë°˜ ëª¨ì„">
                    <div class="error-message" id="eventTitleError">ì¼ì • ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
                </div>

                <div class="form-group">
                    <label class="form-label required">ë‚ ì§œ</label>
                    <input type="date" class="form-input" id="eventDate" required>
                    <div class="error-message" id="eventDateError">ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
                </div>

                <div class="form-group">
                    <label class="form-label required">ì¹´í…Œê³ ë¦¬</label>
                    <select class="form-select" id="eventCategory" required>
                        <option value="">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="school">í•™êµ í–‰ì‚¬</option>
                        <option value="exam">ì‹œí—˜</option>
                        <option value="holiday">íœ´ì¼</option>
                        <option value="class">ë°˜ í–‰ì‚¬</option>
                    </select>
                    <div class="error-message" id="eventCategoryError">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
                </div>

                <div class="form-group">
                    <label class="form-label">ì„¤ëª…</label>
                    <textarea class="form-textarea" id="eventDescription" placeholder="ì¼ì •ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>

                <div class="form-buttons">
                    <button type="button" class="btn-cancel" onclick="closeEventModal()">ì·¨ì†Œ</button>
                    <button type="button" class="btn-submit" id="eventSubmitBtn" onclick="handleEventSubmit()">ì¶”ê°€</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ë¡œì»¬ ì €ì¥ì†Œ ë°ì´í„°ë² ì´ìŠ¤
        class LocalDB {
            constructor() {
                this.dbName = '1-8-isakjupgi-db';
                this.testLocalStorage();
            }

            // localStorage ì‚¬ìš© ê°€ëŠ¥í•œì§€ í…ŒìŠ¤íŠ¸
            testLocalStorage() {
                try {
                    const testKey = 'test-storage';
                    localStorage.setItem(testKey, 'test');
                    localStorage.removeItem(testKey);
                    this.useLocalStorage = true;
                    console.log('âœ… localStorage ì‚¬ìš© ê°€ëŠ¥');
                } catch (error) {
                    this.useLocalStorage = false;
                    console.log('âŒ localStorage ì‚¬ìš© ë¶ˆê°€, ë©”ëª¨ë¦¬ ì €ì¥ ì‚¬ìš©');
                    window.classDB = window.classDB || {};
                }
            }

            // ë°ì´í„° ì €ì¥
            async save(key, data) {
                try {
                    const storageKey = `${this.dbName}-${key}`;
                    const serializedData = JSON.stringify({
                        data: data,
                        timestamp: Date.now(),
                        version: this.generateVersion()
                    });
                    
                    if (this.useLocalStorage) {
                        localStorage.setItem(storageKey, serializedData);
                    } else {
                        window.classDB[storageKey] = serializedData;
                    }
                    
                    // ì„œë²„ ë™ê¸°í™” ì‹œë®¬ë ˆì´ì…˜
                    await this.syncToServer(key, data);
                    
                    showSyncStatus('ë°ì´í„° ì €ì¥ë¨', 'success');
                    return true;
                } catch (error) {
                    console.error('ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', error);
                    showSyncStatus('ì €ì¥ ì‹¤íŒ¨', 'error');
                    return false;
                }
            }

            // ë°ì´í„° ë¡œë“œ
            async load(key) {
                try {
                    const storageKey = `${this.dbName}-${key}`;
                    let stored = null;
                    
                    if (this.useLocalStorage) {
                        stored = localStorage.getItem(storageKey);
                    } else {
                        window.classDB = window.classDB || {};
                        stored = window.classDB[storageKey];
                    }
                    
                    if (stored) {
                        const parsed = JSON.parse(stored);
                        console.log(`ğŸ“ ${key} ë°ì´í„° ë¡œë“œë¨:`, parsed.data?.length || 'N/A', 'ê°œ í•­ëª©');
                        return parsed.data;
                    }
                    
                    console.log(`ğŸ”­ ${key} ë°ì´í„° ì—†ìŒ`);
                    return null;
                } catch (error) {
                    console.error('ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                    return null;
                }
            }

            // ì„œë²„ ë™ê¸°í™” ì‹œë®¬ë ˆì´ì…˜
            async syncToServer(key, data) {
                return new Promise((resolve) => {
                    // ë„¤íŠ¸ì›Œí¬ ì§€ì—° ì‹œë®¬ë ˆì´ì…˜
                    setTimeout(() => {
                        console.log(`ğŸŒ [ì„œë²„ ë™ê¸°í™”] ${key} ë°ì´í„°ê°€ ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                        resolve(true);
                    }, 500);
                });
            }

            generateVersion() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            // ì‹¤ì‹œê°„ ë™ê¸°í™” (localStorage ë³€ê²½ ê°ì§€)
            async startRealTimeSync() {
                // localStorage ë³€ê²½ ê°ì§€ (ë‹¤ë¥¸ íƒ­ì—ì„œì˜ ë³€ê²½ì‚¬í•­)
                if (this.useLocalStorage) {
                    window.addEventListener('storage', (e) => {
                        if (e.key && e.key.startsWith(this.dbName)) {
                            console.log('ğŸ”„ ë‹¤ë¥¸ íƒ­ì—ì„œ ë°ì´í„° ë³€ê²½ ê°ì§€ë¨');
                            showSyncStatus('ë‹¤ë¥¸ íƒ­ì—ì„œ ì—…ë°ì´íŠ¸ë¨', 'success');
                            this.refreshCurrentPage();
                        }
                    });
                }
                
                // ì£¼ê¸°ì  ë™ê¸°í™” ì‹œë®¬ë ˆì´ì…˜
                setInterval(async () => {
                    // ì‹¤ì œë¡œëŠ” ì„œë²„ì™€ ë™ê¸°í™”
                    console.log('ğŸ”„ ì£¼ê¸°ì  ë™ê¸°í™” ì²´í¬...');
                }, 30000); // 30ì´ˆë§ˆë‹¤ í™•ì¸
            }

            async refreshCurrentPage() {
                await loadAllData();
                if (document.getElementById('learningPage').classList.contains('active')) {
                    renderMaterials();
                    filterAndSort();
                }
                if (document.getElementById('schedulePage').classList.contains('active')) {
                    renderCalendar();
                }
            }

            // ëª¨ë“  ë°ì´í„° ì‚­ì œ (ë””ë²„ê¹…ìš©)
            clearAllData() {
                const keys = ['materials', 'events', 'comments', 'likedMaterials'];
                keys.forEach(key => {
                    const storageKey = `${this.dbName}-${key}`;
                    if (this.useLocalStorage) {
                        localStorage.removeItem(storageKey);
                    } else {
                        delete window.classDB[storageKey];
                    }
                });
                console.log('ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì‚­ì œë¨');
                showSyncStatus('ë°ì´í„° ì´ˆê¸°í™”ë¨', 'success');
            }
        }

        // ì „ì—­ ë³€ìˆ˜
        let db = new LocalDB();
        let materials = [];
        let events = [];
        let comments = [];
        let selectedFiles = [];
        let currentSort = 'latest';
        let currentSubject = 'all';
        let currentSearch = '';
        let currentDate = new Date();
        let likedMaterials = [];

        // ë™ê¸°í™” ìƒíƒœ í‘œì‹œ
        function showSyncStatus(message, type = 'success') {
            const statusEl = document.getElementById('syncStatus');
            const textEl = document.getElementById('syncText');
            
            textEl.textContent = message;
            statusEl.className = `sync-status show ${type}`;
            
            setTimeout(() => {
                statusEl.classList.remove('show');
            }, 3000);
        }

        // í¼ ìœ íš¨ì„± ê²€ì‚¬ í•¨ìˆ˜ (ë””ë²„ê¹… ê°•í™”)
        function validateEventForm() {
            const titleElement = document.getElementById('eventTitle');
            const dateElement = document.getElementById('eventDate');
            const categoryElement = document.getElementById('eventCategory');
            
            const title = titleElement.value.trim();
            const date = dateElement.value;
            const category = categoryElement.value;
            
            console.log('ğŸ” í¼ ìœ íš¨ì„± ê²€ì‚¬:', {
                title: `"${title}"`,
                date: `"${date}"`, 
                category: `"${category}"`,
                titleLength: title.length,
                titleRaw: titleElement.value
            });
            
            let isValid = true;
            
            // ì—ëŸ¬ ìƒíƒœ ì´ˆê¸°í™”
            clearEventFormErrors();
            
            // ì œëª© ê²€ì¦
            if (!title || title.length === 0) {
                console.log('âŒ ì œëª© ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨');
                showFieldError('eventTitle', 'eventTitleError');
                isValid = false;
            }
            
            // ë‚ ì§œ ê²€ì¦
            if (!date) {
                console.log('âŒ ë‚ ì§œ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨');
                showFieldError('eventDate', 'eventDateError');
                isValid = false;
            }
            
            // ì¹´í…Œê³ ë¦¬ ê²€ì¦
            if (!category) {
                console.log('âŒ ì¹´í…Œê³ ë¦¬ ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨');
                showFieldError('eventCategory', 'eventCategoryError');
                isValid = false;
            }
            
            console.log('âœ… ìœ íš¨ì„± ê²€ì‚¬ ê²°ê³¼:', isValid);
            return isValid;
        }

        function showFieldError(fieldId, errorId) {
            const field = document.getElementById(fieldId);
            const error = document.getElementById(errorId);
            
            field.classList.add('error');
            error.classList.add('show');
        }

        function clearEventFormErrors() {
            const fields = ['eventTitle', 'eventDate', 'eventCategory'];
            const errors = ['eventTitleError', 'eventDateError', 'eventCategoryError'];
            
            fields.forEach(fieldId => {
                document.getElementById(fieldId).classList.remove('error');
            });
            
            errors.forEach(errorId => {
                document.getElementById(errorId).classList.remove('show');
            });
        }

        // ë°ì´í„° ì €ì¥
        async function saveData() {
            try {
                console.log('ğŸ’¾ ë°ì´í„° ì €ì¥ ì‹œì‘...');
                const results = await Promise.all([
                    db.save('materials', materials),
                    db.save('events', events),
                    db.save('comments', comments),
                    db.save('likedMaterials', likedMaterials)
                ]);
                
                const allSuccess = results.every(result => result === true);
                console.log('ğŸ’¾ ì €ì¥ ê²°ê³¼:', allSuccess ? 'ì„±ê³µ' : 'ì‹¤íŒ¨');
                return allSuccess;
            } catch (error) {
                console.error('âŒ ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜:', error);
                return false;
            }
        }

        // ë°ì´í„° ë¡œë“œ
        async function loadAllData() {
            try {
                console.log('ğŸ“‚ ë°ì´í„° ë¡œë“œ ì‹œì‘...');
                
                const loadedMaterials = await db.load('materials');
                const loadedEvents = await db.load('events');
                const loadedComments = await db.load('comments');
                const loadedLikes = await db.load('likedMaterials');

                let hasData = false;

                if (loadedMaterials && loadedMaterials.length > 0) {
                    materials = loadedMaterials;
                    hasData = true;
                }
                
                if (loadedEvents && loadedEvents.length > 0) {
                    events = loadedEvents;
                    hasData = true;
                }
                
                if (loadedComments && loadedComments.length > 0) {
                    comments = loadedComments;
                    hasData = true;
                }
                
                if (loadedLikes && loadedLikes.length > 0) {
                    likedMaterials = loadedLikes;
                    hasData = true;
                }

                console.log('ğŸ“Š ë¡œë“œëœ ë°ì´í„°:', {
                    materials: materials.length,
                    events: events.length,
                    comments: comments.length,
                    likes: likedMaterials.length,
                    hasExistingData: hasData
                });

                return hasData;
            } catch (error) {
                console.error('âŒ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
                return false;
            }
        }

        // ìƒ˜í”Œ ë°ì´í„° ì´ˆê¸°í™” (ì²« ì‚¬ìš©ììš©)
        function initSampleData() {
            if (materials.length === 0) {
                materials = [
                    {
                        id: 1,
                        title: "ì‚¼ê°í•¨ìˆ˜ ì •ë¦¬ ë…¸íŠ¸",
                        author: "ê¹€ë¯¼ì¤€",
                        subject: "ìˆ˜í•™",
                        description: "ì‚¼ê°í•¨ìˆ˜ì˜ ê¸°ë³¸ ê³µì‹ë“¤ê³¼ ê·¸ë˜í”„ íŠ¹ì„±ì„ ì •ë¦¬í•œ ìë£Œì…ë‹ˆë‹¤. ì‹œí—˜ ì¤€ë¹„ì— ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”!",
                        files: [
                            { name: "ì‚¼ê°í•¨ìˆ˜_ê³µì‹.pdf", type: "pdf" },
                            { name: "ê·¸ë˜í”„_ì˜ˆì‹œ.jpg", type: "image" }
                        ],
                        date: "2025-07-30",
                        likes: 12,
                        comments: 3
                    },
                    {
                        id: 2,
                        title: "ì˜ì–´ ë‹¨ì–´ ì•”ê¸°ë²•",
                        author: "ì´ì„œì—°",
                        subject: "ì˜ì–´",
                        description: "íš¨ê³¼ì ì¸ ì˜ì–´ ë‹¨ì–´ ì•”ê¸° ë°©ë²•ì„ ì˜ìƒìœ¼ë¡œ ì„¤ëª…í–ˆìŠµë‹ˆë‹¤. ì—°ìƒë²•ê³¼ ì–´ê·¼ í™œìš©ë²• ì¤‘ì‹¬ìœ¼ë¡œ ë‹¤ë¤˜ì–´ìš”.",
                        files: [
                            { name: "ì•”ê¸°ë²•_ì„¤ëª….mp4", type: "video" },
                            { name: "ë‹¨ì–´ì¥.docx", type: "document" }
                        ],
                        date: "2025-07-29",
                        likes: 8,
                        comments: 5
                    },
                    {
                        id: 3,
                        title: "í™”í•™ ì‹¤í—˜ ë³´ê³ ì„œ",
                        author: "ë°•ì¤€í˜•",
                        subject: "ê³¼í•™",
                        description: "ì‚°ê³¼ ì—¼ê¸°ì˜ ì¤‘í™”ë°˜ì‘ ì‹¤í—˜ ê²°ê³¼ë¥¼ ì •ë¦¬í•œ ë³´ê³ ì„œì…ë‹ˆë‹¤. ì‹¤í—˜ ê³¼ì • ì‚¬ì§„ë„ í¬í•¨ë˜ì–´ ìˆì–´ìš”.",
                        files: [
                            { name: "ì‹¤í—˜ë³´ê³ ì„œ.pdf", type: "pdf" },
                            { name: "ì‹¤í—˜ì‚¬ì§„.jpg", type: "image" }
                        ],
                        date: "2025-07-28",
                        likes: 15,
                        comments: 2
                    },
                    {
                        id: 4,
                        title: "ë¬¸í•™ ì‘í’ˆ ë¶„ì„",
                        author: "ìµœìœ ì§„",
                        subject: "êµ­ì–´",
                        description: "ìœ¤ë™ì£¼ì˜ 'ì„œì‹œ' ì‘í’ˆì„ í™”ì, ìƒí™©, ì •ì„œ, í‘œí˜„ ê¸°ë²• ë“±ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë¶„ì„í•œ ìë£Œì…ë‹ˆë‹¤.",
                        files: [
                            { name: "ì‘í’ˆë¶„ì„.hwp", type: "document" }
                        ],
                        date: "2025-07-27",
                        likes: 6,
                        comments: 1
                    },
                    {
                        id: 5,
                        title: "ì˜¬ë°”ë¥¸ ì† ì”»ê¸° ë°©ë²•",
                        author: "ì •í•˜ëŠ˜",
                        subject: "ë³´ê±´",
                        description: "ê°ì—¼ë³‘ ì˜ˆë°©ì„ ìœ„í•œ ì˜¬ë°”ë¥¸ ì† ì”»ê¸° 6ë‹¨ê³„ë¥¼ ì˜ìƒìœ¼ë¡œ ì‹œì—°í•˜ê³ , ë³´ê±´ ìˆ˜ì¹™ë„ í•¨ê»˜ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤.",
                        files: [
                            { name: "ì†ì”»ê¸°_ì‹œì—°.mp4", type: "video" },
                            { name: "ë³´ê±´ìˆ˜ì¹™.pdf", type: "pdf" }
                        ],
                        date: "2025-07-26",
                        likes: 9,
                        comments: 4
                    }
                ];
            }

            if (events.length === 0) {
                events = [
                    {
                        id: 1,
                        title: "ì¤‘ê°„ê³ ì‚¬",
                        date: "2025-08-25",
                        category: "exam",
                        description: "1í•™ê¸° ì¤‘ê°„ê³ ì‚¬"
                    },
                    {
                        id: 2,
                        title: "ì²´ìœ¡ëŒ€íšŒ",
                        date: "2025-09-05",
                        category: "school",
                        description: "ì „êµ ì²´ìœ¡ëŒ€íšŒ"
                    },
                    {
                        id: 3,
                        title: "ë°˜ íšŒì‹",
                        date: "2025-09-15",
                        category: "class",
                        description: "1-8ë°˜ ë°˜ íšŒì‹"
                    }
                ];
            }

            if (comments.length === 0) {
                comments = [
                    { id: 1, materialId: 1, author: "ì´ì„œì—°", content: "ì •ë§ ìœ ìš©í•œ ìë£Œë„¤ìš”! ê°ì‚¬í•©ë‹ˆë‹¤ ğŸ‘", date: "2025-07-30 15:30" },
                    { id: 2, materialId: 1, author: "ë°•ì¤€í˜•", content: "ì‹œí—˜ ì¤€ë¹„ì— ë„ì›€ì´ ë  ê²ƒ ê°™ì•„ìš”", date: "2025-07-30 16:20" },
                    { id: 3, materialId: 1, author: "ìµœìœ ì§„", content: "ê·¸ë˜í”„ í•´ì„ ë¶€ë¶„ì´ íŠ¹íˆ ì¢‹ë„¤ìš”!", date: "2025-07-30 18:45" },
                    { id: 4, materialId: 2, author: "ê¹€ë¯¼ì¤€", content: "ì•”ê¸°ë²• ì˜ìƒ ì •ë§ ë„ì›€ëì–´ìš”!", date: "2025-07-29 14:15" },
                    { id: 5, materialId: 2, author: "ì •í•˜ëŠ˜", content: "ì—°ìƒë²• í™œìš©í•´ì„œ ë‹¨ì–´ ì™¸ì›Œë³¼ê²Œìš”", date: "2025-07-29 19:30" }
                ];
            }
        }

        // í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜
        function navigateToPage(page) {
            document.querySelectorAll('.page-container, .home-page').forEach(p => {
                p.style.display = 'none';
                p.classList.remove('active');
            });

            if (page === 'home') {
                document.getElementById('homePage').style.display = 'flex';
            } else if (page === 'learning') {
                document.getElementById('learningPage').style.display = 'block';
                document.getElementById('learningPage').classList.add('active');
                setTimeout(() => {
                    renderMaterials();
                    filterAndSort();
                }, 100);
            } else if (page === 'schedule') {
                document.getElementById('schedulePage').style.display = 'block';
                document.getElementById('schedulePage').classList.add('active');
                setTimeout(() => {
                    renderCalendar();
                }, 100);
            }
        }

        // íŒŒì¼ ì•„ì´ì½˜ ê°€ì ¸ì˜¤ê¸°
        function getFileIcon(type) {
            const icons = {
                pdf: 'ğŸ“„',
                image: 'ğŸ“·',
                video: 'ğŸ¥',
                document: 'ğŸ“„',
                audio: 'ğŸµ',
                default: 'ğŸ“'
            };
            return icons[type] || icons.default;
        }

        // ìë£Œ ëª©ë¡ ë Œë”ë§
        function renderMaterials() {
            const grid = document.getElementById('materialsGrid');
            if (!grid) {
                console.error('âŒ materialsGrid ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log('ğŸ¨ ìë£Œ ëª©ë¡ ë Œë”ë§ ì‹œì‘:', materials.length, 'ê°œ');
            grid.innerHTML = '';

            if (materials.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: #6b7280;">
                        <div style="font-size: 3rem; margin-bottom: 16px;">ğŸ“š</div>
                        <h3 style="font-size: 1.25rem; margin-bottom: 8px; color: #374151;">ì•„ì§ ì—…ë¡œë“œëœ ìë£Œê°€ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p style="font-size: 0.875rem;">ì²« ë²ˆì§¸ í•™ìŠµìë£Œë¥¼ ì—…ë¡œë“œí•´ë³´ì„¸ìš”!</p>
                        <button onclick="openUploadModal()" style="margin-top: 16px; background: #3b82f6; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;">+ ìë£Œ ì—…ë¡œë“œ</button>
                    </div>
                `;
                return;
            }

            materials.forEach((material, index) => {
                const card = document.createElement('div');
                card.className = 'material-card';
                card.dataset.subject = material.subject;
                card.dataset.date = material.date;
                card.dataset.likes = material.likes;

                const filesHtml = material.files && material.files.length > 0 ? 
                    material.files.map(file => 
                        `<span class="file-tag" onclick="downloadFile('${file.name}')">${getFileIcon(file.type)} ${file.name}</span>`
                    ).join('') : 
                    '<span style="color: #9ca3af; font-size: 0.75rem;">ì²¨ë¶€íŒŒì¼ ì—†ìŒ</span>';

                const isLiked = likedMaterials.includes(material.id);
                const materialComments = comments.filter(c => c.materialId === material.id);

                card.innerHTML = `
                    <div class="material-header">
                        <div>
                            <div class="material-title">${material.title}</div>
                            <div class="material-meta">
                                <span>ì‘ì„±ì: ${material.author}</span>
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <span class="material-subject">${material.subject}</span>
                            <button class="edit-btn" onclick="editMaterial(${material.id})" title="ìë£Œ ìˆ˜ì •">
                                âœï¸
                            </button>
                            <button class="delete-btn" onclick="deleteMaterial(${material.id})" title="ìë£Œ ì‚­ì œ">
                                ğŸ—‘ï¸
                            </button>
                        </div>
                    </div>
                    <div class="material-description">
                        ${material.description}
                    </div>
                    <div class="material-files">
                        ${filesHtml}
                    </div>
                    <div class="material-actions">
                        <div class="like-section">
                            <button class="like-btn ${isLiked ? 'liked' : ''}" onclick="toggleLike(${material.id})">
                                <span>${isLiked ? 'â¤ï¸' : 'ğŸ¤'}</span>
                                <span>${material.likes}</span>
                            </button>
                        </div>
                        <button class="comment-toggle" onclick="toggleComments(${material.id})">
                            ğŸ’¬ ${materialComments.length}ê°œ
                        </button>
                    </div>
                    <div class="material-date">${material.date.replace(/-/g, '.')}</div>
                    
                    <div class="comments-section" id="comments-${material.id}">
                        <div class="comment-form">
                            <input type="text" class="comment-input" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleCommentKeyPress(event, ${material.id})">
                            <button class="comment-submit" onclick="addComment(${material.id})">ë“±ë¡</button>
                        </div>
                        <div class="comments-list" id="comments-list-${material.id}">
                            ${renderCommentsForMaterial(material.id)}
                        </div>
                    </div>
                `;

                grid.appendChild(card);
            });
            
            console.log('âœ… ìë£Œ ëª©ë¡ ë Œë”ë§ ì™„ë£Œ:', materials.length, 'ê°œ');
        }

        // ìë£Œë³„ ëŒ“ê¸€ ë Œë”ë§
        function renderCommentsForMaterial(materialId) {
            const materialComments = comments.filter(c => c.materialId === materialId);
            return materialComments.map(comment => `
                <div class="comment-item">
                    <div class="comment-header">
                        <span class="comment-author">${comment.author}</span>
                        <span class="comment-date">${comment.date}</span>
                    </div>
                    <div class="comment-content">${comment.content}</div>
                </div>
            `).join('');
        }

        // ì¢‹ì•„ìš” í† ê¸€
        async function toggleLike(materialId) {
            const material = materials.find(m => m.id === materialId);
            const isLiked = likedMaterials.includes(materialId);

            if (isLiked) {
                likedMaterials = likedMaterials.filter(id => id !== materialId);
                material.likes--;
            } else {
                likedMaterials.push(materialId);
                material.likes++;
            }

            await saveData();
            renderMaterials();
            filterAndSort();
        }

        // ëŒ“ê¸€ ì„¹ì…˜ í† ê¸€
        function toggleComments(materialId) {
            const commentsSection = document.getElementById(`comments-${materialId}`);
            commentsSection.classList.toggle('active');
        }

        // ëŒ“ê¸€ ì¶”ê°€
        async function addComment(materialId) {
            const input = document.querySelector(`#comments-${materialId} .comment-input`);
            const content = input.value.trim();
            
            if (!content) return;

            const newComment = {
                id: Date.now(), // ê³ ìœ  ID ìƒì„±
                materialId: materialId,
                author: "ë‚˜", // ì‹¤ì œë¡œëŠ” ë¡œê·¸ì¸í•œ ì‚¬ìš©ìëª…
                content: content,
                date: new Date().toLocaleString('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                }).replace(/\. /g, '-').replace(/\.$/, '').replace(' ', ' ')
            };

            comments.push(newComment);

            // ëŒ“ê¸€ ìˆ˜ ì¦ê°€
            const material = materials.find(m => m.id === materialId);
            material.comments++;

            input.value = '';
            
            await saveData();
            
            // ëŒ“ê¸€ ëª©ë¡ ì—…ë°ì´íŠ¸
            const commentsList = document.getElementById(`comments-list-${materialId}`);
            commentsList.innerHTML = renderCommentsForMaterial(materialId);

            // ì¹´ë“œ ìƒˆë¡œê³ ì¹¨
            renderMaterials();
            filterAndSort();
            
            // ëŒ“ê¸€ ì„¹ì…˜ ì—´ê¸°
            document.getElementById(`comments-${materialId}`).classList.add('active');
        }

        // ì—”í„°í‚¤ë¡œ ëŒ“ê¸€ ì¶”ê°€
        function handleCommentKeyPress(event, materialId) {
            if (event.key === 'Enter') {
                addComment(materialId);
            }
        }

        // íŒŒì¼ ë‹¤ìš´ë¡œë“œ (ì‹œë®¬ë ˆì´ì…˜)
        function downloadFile(filename) {
            alert(`"${filename}" íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.`);
        }

        // í•™ìŠµìë£Œ ì‚­ì œ í•¨ìˆ˜ (í™•ì¸ ì—†ì´ ë°”ë¡œ ì‚­ì œ)
        async function deleteMaterial(materialId) {
            try {
                // ì‚­ì œí•  ìë£Œ ì°¾ê¸°
                const material = materials.find(m => m.id === materialId);
                if (!material) {
                    alert('ì‚­ì œí•  ìë£Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                console.log('ğŸ—‘ï¸ ìë£Œ ì‚­ì œ ì‹œì‘:', materialId, material.title);
                
                // ìë£Œ ë°°ì—´ì—ì„œ ì œê±°
                const materialIndex = materials.findIndex(m => m.id === materialId);
                materials.splice(materialIndex, 1);
                console.log('âœ… ìë£Œ ë°°ì—´ì—ì„œ ì œê±°ë¨. ë‚¨ì€ ìë£Œ ìˆ˜:', materials.length);
                
                // ê´€ë ¨ ëŒ“ê¸€ë“¤ë„ ì‚­ì œ
                const originalCommentsCount = comments.length;
                comments = comments.filter(c => c.materialId !== materialId);
                const deletedCommentsCount = originalCommentsCount - comments.length;
                console.log(`ğŸ—‘ï¸ ê´€ë ¨ ëŒ“ê¸€ ${deletedCommentsCount}ê°œ ì‚­ì œë¨`);
                
                // ì¢‹ì•„ìš” ëª©ë¡ì—ì„œë„ ì œê±°
                likedMaterials = likedMaterials.filter(id => id !== materialId);
                console.log('ğŸ—‘ï¸ ì¢‹ì•„ìš” ëª©ë¡ì—ì„œ ì œê±°ë¨');
                
                // ë°ì´í„° ì €ì¥
                await saveData();
                console.log('ğŸ’¾ ë°ì´í„° ì €ì¥ ì™„ë£Œ');
                
                // í™”ë©´ ìƒˆë¡œê³ ì¹¨
                if (document.getElementById('learningPage').classList.contains('active')) {
                    renderMaterials();
                    filterAndSort();
                }
                
                showSyncStatus(`"${material.title}" ì‚­ì œë¨`, 'success');
                console.log('ğŸ‰ ìë£Œ ì‚­ì œ ì™„ë£Œ!');
                
            } catch (error) {
                console.error('âŒ ìë£Œ ì‚­ì œ ì¤‘ ì˜¤ë¥˜:', error);
                alert('ìë£Œ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                showSyncStatus('ìë£Œ ì‚­ì œ ì‹¤íŒ¨', 'error');
            }
        }

        // í•™ìŠµìë£Œ ìˆ˜ì • í•¨ìˆ˜
        function editMaterial(materialId) {
            const material = materials.find(m => m.id === materialId);
            if (!material) {
                alert('ìˆ˜ì •í•  ìë£Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log('âœï¸ ìë£Œ ìˆ˜ì • ì‹œì‘:', material);
            
            // ì „ì—­ ë³€ìˆ˜ë¡œ í˜„ì¬ ìˆ˜ì • ì¤‘ì¸ ìë£Œ ID ì €ì¥
            window.editingMaterialId = materialId;
            
            // ì—…ë¡œë“œ ëª¨ë‹¬ì„ ìˆ˜ì • ëª¨ë“œë¡œ ì—´ê¸°
            document.getElementById('uploadModal').classList.add('active');
            
            // ëª¨ë‹¬ ì œëª© ë³€ê²½
            document.querySelector('#uploadModal .modal-title').textContent = 'ìë£Œ ìˆ˜ì •';
            document.getElementById('uploadSubmitBtn').textContent = 'ìˆ˜ì • ì™„ë£Œ';
            
            // ê¸°ì¡´ ë°ì´í„°ë¥¼ í¼ì— ì±„ìš°ê¸°
            document.getElementById('materialTitle').value = material.title;
            document.getElementById('materialAuthor').value = material.author;
            document.getElementById('materialSubject').value = material.subject;
            document.getElementById('materialDescription').value = material.description;
            
            // ê¸°ì¡´ íŒŒì¼ ì •ë³´ í‘œì‹œ (ì‹¤ì œ íŒŒì¼ì€ ì—†ìœ¼ë‹ˆ ì •ë³´ë§Œ)
            const filesContainer = document.getElementById('selectedFiles');
            filesContainer.innerHTML = '';
            
            if (material.files && material.files.length > 0) {
                material.files.forEach(file => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <span class="file-icon">${getFileIcon(file.type)}</span>
                            <span>${file.name} (ê¸°ì¡´ íŒŒì¼)</span>
                        </div>
                    `;
                    filesContainer.appendChild(fileItem);
                });
            }
            
            selectedFiles = []; // ìƒˆë¡œ ì„ íƒëœ íŒŒì¼ì€ ì´ˆê¸°í™”
        }

        // ì •ë ¬ ë° í•„í„°ë§
        function sortBy(type) {
            currentSort = type;
            
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            if (type === 'latest') {
                currentSubject = 'all';
                document.querySelectorAll('.subject-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector('.subject-btn[onclick="filterBySubject(\'all\')"]').classList.add('active');
            }

            filterAndSort();
        }

        function filterBySubject(subject) {
            currentSubject = subject;
            
            document.querySelectorAll('.subject-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            filterAndSort();
        }

        function searchMaterials(keyword) {
            currentSearch = keyword.toLowerCase();
            filterAndSort();
        }

        function filterAndSort() {
            const cards = Array.from(document.querySelectorAll('.material-card'));
            
            cards.forEach(card => {
                const subject = card.dataset.subject;
                const title = card.querySelector('.material-title').textContent.toLowerCase();
                const author = card.querySelector('.material-meta span').textContent.toLowerCase();
                
                const subjectMatch = currentSubject === 'all' || subject === currentSubject;
                const searchMatch = currentSearch === '' || 
                    title.includes(currentSearch) || 
                    author.includes(currentSearch) ||
                    subject.toLowerCase().includes(currentSearch);
                
                if (subjectMatch && searchMatch) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });

            const visibleCards = cards.filter(card => card.style.display !== 'none');
            const grid = document.getElementById('materialsGrid');
            
            if (currentSort === 'latest') {
                visibleCards.sort((a, b) => new Date(b.dataset.date) - new Date(a.dataset.date));
            } else if (currentSort === 'subject') {
                visibleCards.sort((a, b) => {
                    const subjectA = a.dataset.subject;
                    const subjectB = b.dataset.subject;
                    if (subjectA === subjectB) {
                        return new Date(b.dataset.date) - new Date(a.dataset.date);
                    }
                    return subjectA.localeCompare(subjectB);
                });
            } else if (currentSort === 'popular') {
                visibleCards.sort((a, b) => parseInt(b.dataset.likes) - parseInt(a.dataset.likes));
            }

            visibleCards.forEach(card => grid.appendChild(card));
        }

        // íŒŒì¼ ì—…ë¡œë“œ ëª¨ë‹¬
        function openUploadModal() {
            console.log('ğŸ“‚ ì—…ë¡œë“œ ëª¨ë‹¬ ì—´ê¸°');
            document.getElementById('uploadModal').classList.add('active');
            resetUploadForm();
        }

        function closeUploadModal() {
            console.log('ğŸ“‚ ì—…ë¡œë“œ ëª¨ë‹¬ ë‹«ê¸°');
            document.getElementById('uploadModal').classList.remove('active');
            resetUploadForm();
            
            // ìˆ˜ì • ëª¨ë“œ í•´ì œ
            window.editingMaterialId = null;
            document.querySelector('#uploadModal .modal-title').textContent = 'ìƒˆ ìë£Œ ì—…ë¡œë“œ';
            document.getElementById('uploadSubmitBtn').textContent = 'ì—…ë¡œë“œ';
        }

        function resetUploadForm() {
            console.log('ğŸ”„ ì—…ë¡œë“œ í¼ ì´ˆê¸°í™”');
            const form = document.getElementById('uploadForm');
            if (form) {
                form.reset();
            }
            selectedFiles = [];
            updateSelectedFilesDisplay();
        }

        // íŒŒì¼ ì„ íƒ ì²˜ë¦¬
        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            selectedFiles = [...selectedFiles, ...files];
            updateSelectedFilesDisplay();
        }

        function updateSelectedFilesDisplay() {
            const container = document.getElementById('selectedFiles');
            container.innerHTML = '';

            selectedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                const fileType = getFileTypeFromName(file.name);
                fileItem.innerHTML = `
                    <div class="file-info">
                        <span class="file-icon">${getFileIcon(fileType)}</span>
                        <span>${file.name}</span>
                    </div>
                    <button type="button" class="remove-file" onclick="removeFile(${index})">Ã—</button>
                `;
                
                container.appendChild(fileItem);
            });
        }

        function getFileTypeFromName(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const types = {
                'pdf': 'pdf',
                'jpg': 'image', 'jpeg': 'image', 'png': 'image', 'gif': 'image',
                'mp4': 'video', 'avi': 'video', 'mov': 'video',
                'mp3': 'audio', 'wav': 'audio',
                'doc': 'document', 'docx': 'document', 'hwp': 'document'
            };
            return types[ext] || 'default';
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateSelectedFilesDisplay();
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì²˜ë¦¬
        function initFileUpload() {
            const fileUploadArea = document.getElementById('fileUploadArea');
            
            if (fileUploadArea) {
                console.log('ğŸ“ íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ ì´ˆê¸°í™”');
                
                fileUploadArea.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('dragover');
                });

                fileUploadArea.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                });

                fileUploadArea.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                    
                    const files = Array.from(e.dataTransfer.files);
                    console.log('ğŸ“ ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ íŒŒì¼ ì¶”ê°€ë¨:', files.length, 'ê°œ');
                    selectedFiles = [...selectedFiles, ...files];
                    updateSelectedFilesDisplay();
                });
                
                // íŒŒì¼ ì…ë ¥ í´ë¦­ ì´ë²¤íŠ¸ë„ ì¶”ê°€
                const fileInput = document.getElementById('fileInput');
                if (fileInput) {
                    fileInput.addEventListener('change', handleFileSelect);
                    console.log('ğŸ“ íŒŒì¼ ì…ë ¥ ì´ë²¤íŠ¸ ë“±ë¡ë¨');
                }
            } else {
                console.error('âŒ íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // ì—…ë¡œë“œ í¼ ì œì¶œ
        function initUploadForm() {
            const uploadForm = document.getElementById('uploadForm');
            const submitBtn = document.getElementById('uploadSubmitBtn');
            
            if (!uploadForm) {
                console.error('âŒ ì—…ë¡œë“œ í¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log('ğŸ”§ ì—…ë¡œë“œ í¼ ì´ˆê¸°í™” ì¤‘...');
            
            // ê¸°ì¡´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° (ì¤‘ë³µ ë°©ì§€)
            uploadForm.removeEventListener('submit', handleUploadSubmit);
            
            // í¼ ì œì¶œ ì´ë²¤íŠ¸ ë“±ë¡
            uploadForm.addEventListener('submit', handleUploadSubmit);
            
            // ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ë„ ë³„ë„ë¡œ ë“±ë¡ (ë”ë¸” ì²´í¬)
            if (submitBtn) {
                submitBtn.removeEventListener('click', handleUploadClick);
                submitBtn.addEventListener('click', handleUploadClick);
                console.log('âœ… ì—…ë¡œë“œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë“±ë¡ë¨');
            }
            
            console.log('âœ… ì—…ë¡œë“œ í¼ ì´ˆê¸°í™” ì™„ë£Œ');
        }

        // ì—…ë¡œë“œ ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬
        function handleUploadClick(e) {
            console.log('ğŸ–±ï¸ ì—…ë¡œë“œ ë²„íŠ¼ í´ë¦­ë¨');
            
            // ë²„íŠ¼ì´ submit íƒ€ì…ì´ë©´ í¼ ì œì¶œì´ ìë™ìœ¼ë¡œ ë°œìƒ
            // ë§Œì•½ submit ì´ë²¤íŠ¸ê°€ ì‘ë™í•˜ì§€ ì•Šìœ¼ë©´ ì§ì ‘ ì²˜ë¦¬
            const form = document.getElementById('uploadForm');
            if (form) {
                e.preventDefault();
                handleUploadSubmit(e);
            }
        }

        // ì—…ë¡œë“œ í¼ ì œì¶œ í•¸ë“¤ëŸ¬ (ìˆ˜ì • ëª¨ë“œ ì§€ì›)
        async function handleUploadSubmit(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const isEditMode = window.editingMaterialId != null;
            console.log(isEditMode ? 'âœï¸ ìë£Œ ìˆ˜ì • ì œì¶œ ì‹œì‘...' : 'ğŸš€ ìƒˆ ìë£Œ ì—…ë¡œë“œ ì œì¶œ ì‹œì‘...');
            
            try {
                const title = document.getElementById('materialTitle').value.trim();
                const author = document.getElementById('materialAuthor').value.trim();
                const subject = document.getElementById('materialSubject').value;
                const description = document.getElementById('materialDescription').value.trim();
                
                console.log('ğŸ“ í¼ ë°ì´í„° í™•ì¸:', { 
                    title: title || '(ë¹„ì–´ìˆìŒ)', 
                    author: author || '(ë¹„ì–´ìˆìŒ)', 
                    subject: subject || '(ì„ íƒì•ˆë¨)', 
                    description: description || '(ë¹„ì–´ìˆìŒ)',
                    fileCount: selectedFiles.length,
                    isEditMode: isEditMode
                });
                
                // í•„ìˆ˜ í•­ëª© ê²€ì¦
                if (!title) {
                    alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    document.getElementById('materialTitle').focus();
                    return;
                }
                
                if (!author) {
                    alert('ì‘ì„±ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    document.getElementById('materialAuthor').focus();
                    return;
                }
                
                if (!subject) {
                    alert('ê³¼ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    document.getElementById('materialSubject').focus();
                    return;
                }
                
                console.log('âœ… í•„ìˆ˜ í•­ëª© ê²€ì¦ í†µê³¼');
                
                if (isEditMode) {
                    // ìˆ˜ì • ëª¨ë“œ
                    const materialIndex = materials.findIndex(m => m.id === window.editingMaterialId);
                    if (materialIndex === -1) {
                        alert('ìˆ˜ì •í•  ìë£Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    const existingMaterial = materials[materialIndex];
                    console.log('ğŸ“ ê¸°ì¡´ ìë£Œ:', existingMaterial);
                    
                    // ê¸°ì¡´ ìë£Œ ì—…ë°ì´íŠ¸
                    materials[materialIndex] = {
                        ...existingMaterial,
                        title: title,
                        author: author,
                        subject: subject,
                        description: description || `${subject} ê³¼ëª© í•™ìŠµìë£Œì…ë‹ˆë‹¤.`,
                        // ìƒˆ íŒŒì¼ì´ ì„ íƒë˜ì—ˆìœ¼ë©´ êµì²´, ì•„ë‹ˆë©´ ê¸°ì¡´ íŒŒì¼ ìœ ì§€
                        files: selectedFiles.length > 0 ? 
                            selectedFiles.map(file => ({
                                name: file.name,
                                type: getFileTypeFromName(file.name),
                                size: file.size
                            })) : existingMaterial.files
                    };
                    
                    console.log('âœï¸ ìë£Œ ìˆ˜ì • ì™„ë£Œ:', materials[materialIndex]);
                    showSyncStatus('ìë£Œ ìˆ˜ì • ì¤‘...', 'success');
                    
                } else {
                    // ìƒˆ ìë£Œ ì¶”ê°€ ëª¨ë“œ
                    const newMaterial = {
                        id: Date.now(),
                        title: title,
                        author: author,
                        subject: subject,
                        description: description || `${subject} ê³¼ëª© í•™ìŠµìë£Œì…ë‹ˆë‹¤.`,
                        files: selectedFiles.map(file => ({
                            name: file.name,
                            type: getFileTypeFromName(file.name),
                            size: file.size
                        })),
                        date: new Date().toISOString().split('T')[0],
                        likes: 0,
                        comments: 0
                    };
                    
                    console.log('âœ¨ ìƒˆ ìë£Œ ìƒì„±ë¨:', newMaterial);
                    materials.unshift(newMaterial);
                    showSyncStatus('ìë£Œ ì—…ë¡œë“œ ì¤‘...', 'success');
                }
                
                console.log('ğŸ“š ìë£Œ ë°°ì—´ ì—…ë°ì´íŠ¸ë¨. ì´ ìë£Œ ìˆ˜:', materials.length);
                
                // ë°ì´í„° ì €ì¥
                const saveResult = await saveData();
                
                if (saveResult) {
                    console.log('ğŸ’¾ ë°ì´í„° ì €ì¥ ì„±ê³µ');
                    
                    // ëª¨ë‹¬ ë‹«ê¸°
                    closeUploadModal();
                    
                    // í™”ë©´ ì—…ë°ì´íŠ¸
                    if (document.getElementById('learningPage').classList.contains('active')) {
                        console.log('ğŸ”„ í™”ë©´ ì—…ë°ì´íŠ¸ ì¤‘...');
                        renderMaterials();
                        filterAndSort();
                    }
                    
                    const action = isEditMode ? 'ìˆ˜ì •' : 'ì—…ë¡œë“œ';
                    console.log(`ğŸ‰ ìë£Œ ${action} ì™„ë£Œ!`);
                    showSyncStatus(`ìë£Œ ${action} ì™„ë£Œ! ğŸ‰`, 'success');
                    
                    // ì„±ê³µ ë©”ì‹œì§€
                    setTimeout(() => {
                        alert(`"${title}" ìë£Œê°€ ì„±ê³µì ìœ¼ë¡œ ${action}ë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ ${materials.length}ê°œì˜ ìë£Œê°€ ìˆìŠµë‹ˆë‹¤. ğŸ“š`);
                    }, 500);
                } else {
                    console.error('âŒ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨');
                    alert('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                }
                
            } catch (error) {
                console.error('âŒ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error);
                alert('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                showSyncStatus('ì²˜ë¦¬ ì‹¤íŒ¨', 'error');
            }
        }

        // ìº˜ë¦°ë” ë Œë”ë§
        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            const monthNames = [
                '1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”',
                '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'
            ];
            const dayNames = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
            
            // ì „ì²´ í™”ë©´ í´ë¦­ ì‹œ ì‚­ì œ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.event-item') && !e.target.closest('.event-delete-btn')) {
                    hideDeleteButton();
                }
            });
            
            // í˜„ì¬ ì›” í‘œì‹œ
            document.getElementById('currentMonth').textContent = 
                `${currentDate.getFullYear()}ë…„ ${monthNames[currentDate.getMonth()]}`;
            
            // ìº˜ë¦°ë” ê·¸ë¦¬ë“œ ì´ˆê¸°í™”
            grid.innerHTML = '';
            
            // ìš”ì¼ í—¤ë” ì¶”ê°€
            dayNames.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-day-header';
                header.textContent = day;
                grid.appendChild(header);
            });
            
            // ë‹¬ë ¥ ë‚ ì§œ ê³„ì‚°
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startDay = firstDay.getDay();
            
            // ì´ì „ ë‹¬ì˜ ë§ˆì§€ë§‰ ë‚ ë“¤
            const prevMonth = new Date(year, month - 1, 0);
            for (let i = startDay - 1; i >= 0; i--) {
                const day = prevMonth.getDate() - i;
                const dayElement = createDayElement(day, true, false);
                grid.appendChild(dayElement);
            }
            
            // í˜„ì¬ ë‹¬ì˜ ë‚ ë“¤
            const today = new Date();
            for (let day = 1; day <= daysInMonth; day++) {
                const isToday = year === today.getFullYear() && 
                               month === today.getMonth() && 
                               day === today.getDate();
                const dayElement = createDayElement(day, false, isToday);
                grid.appendChild(dayElement);
            }
            
            // ë‹¤ìŒ ë‹¬ì˜ ì²« ë‚ ë“¤
            const remainingCells = 42 - (startDay + daysInMonth);
            for (let day = 1; day <= remainingCells; day++) {
                const dayElement = createDayElement(day, true, false);
                grid.appendChild(dayElement);
            }
        }

        function createDayElement(day, otherMonth, isToday) {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            
            if (otherMonth) {
                dayElement.classList.add('other-month');
            }
            if (isToday) {
                dayElement.classList.add('today');
            }
            
            const dayNumber = document.createElement('div');
            dayNumber.className = 'day-number';
            dayNumber.textContent = day;
            dayElement.appendChild(dayNumber);
            
            // í•´ë‹¹ ë‚ ì§œì˜ ì´ë²¤íŠ¸ ì¶”ê°€
            if (!otherMonth) {
                const dateStr = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const dayEvents = events.filter(event => event.date === dateStr);
                
                dayEvents.forEach(event => {
                    const eventElement = document.createElement('div');
                    eventElement.className = `event-item ${event.category}`;
                    eventElement.textContent = event.title;
                    
                    // ì¼ë°˜ í´ë¦­ ì´ë²¤íŠ¸ (ìˆ˜ì •)
                    eventElement.onclick = (e) => {
                        if (!isLongPress) {
                            showEventDetails(event);
                        }
                        isLongPress = false; // ë¦¬ì…‹
                    };
                    
                    // ê¸¸ê²Œ ëˆ„ë¥´ê¸° ì´ë²¤íŠ¸ë“¤
                    eventElement.onmousedown = (e) => {
                        e.preventDefault();
                        startLongPress(eventElement, event);
                    };
                    
                    eventElement.onmouseup = () => {
                        cancelLongPress();
                    };
                    
                    eventElement.onmouseleave = () => {
                        cancelLongPress();
                    };
                    
                    // í„°ì¹˜ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼ ì§€ì›)
                    eventElement.ontouchstart = (e) => {
                        e.preventDefault();
                        startLongPress(eventElement, event);
                    };
                    
                    eventElement.ontouchend = (e) => {
                        e.preventDefault();
                        cancelLongPress();
                    };
                    
                    eventElement.ontouchcancel = () => {
                        cancelLongPress();
                    };
                    
                    dayElement.appendChild(eventElement);
                });
            }
            
            return dayElement;
        }

        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            renderCalendar();
        }

        function showEventDetails(event) {
            // ì¼ë°˜ í´ë¦­ ì‹œ ìˆ˜ì • ëª¨ë“œë¡œë§Œ ì´ë™
            editEvent(event.id);
        }

        // ê¸¸ê²Œ ëˆ„ë¥´ê¸° ê°ì§€ ë³€ìˆ˜ë“¤
        let longPressTimer = null;
        let isLongPress = false;
        let currentLongPressEvent = null;

        // ê¸¸ê²Œ ëˆ„ë¥´ê¸° ì‹œì‘
        function startLongPress(event, eventObj) {
            isLongPress = false;
            currentLongPressEvent = eventObj;
            
            longPressTimer = setTimeout(() => {
                isLongPress = true;
                showDeleteButton(event, eventObj);
            }, 800); // 800ms ê¸¸ê²Œ ëˆ„ë¥´ê¸°
        }

        // ê¸¸ê²Œ ëˆ„ë¥´ê¸° ì·¨ì†Œ
        function cancelLongPress() {
            if (longPressTimer) {
                clearTimeout(longPressTimer);
                longPressTimer = null;
            }
            hideDeleteButton();
        }

        // ì‚­ì œ ë²„íŠ¼ í‘œì‹œ
        function showDeleteButton(eventElement, eventObj) {
            // ê¸°ì¡´ ì‚­ì œ ë²„íŠ¼ë“¤ ìˆ¨ê¸°ê¸°
            hideDeleteButton();
            
            // ì‚­ì œ ë²„íŠ¼ ìƒì„±
            const deleteBtn = document.createElement('div');
            deleteBtn.className = 'event-delete-btn';
            deleteBtn.innerHTML = 'ğŸ—‘ï¸';
            deleteBtn.onclick = (e) => {
                e.stopPropagation();
                deleteEvent(eventObj.id);
                hideDeleteButton();
            };
            
            // ì´ë²¤íŠ¸ ìš”ì†Œì— ì‚­ì œ ë²„íŠ¼ ì¶”ê°€
            eventElement.appendChild(deleteBtn);
            eventElement.classList.add('long-pressed');
            
            console.log('ğŸ”„ ê¸¸ê²Œ ëˆ„ë¥´ê¸° ê°ì§€ - ì‚­ì œ ë²„íŠ¼ í‘œì‹œ:', eventObj.title);
        }

        // ì‚­ì œ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
        function hideDeleteButton() {
            const deleteButtons = document.querySelectorAll('.event-delete-btn');
            deleteButtons.forEach(btn => btn.remove());
            
            const longPressedEvents = document.querySelectorAll('.event-item.long-pressed');
            longPressedEvents.forEach(event => event.classList.remove('long-pressed'));
        }

        // ì¼ì • ì‚­ì œ í•¨ìˆ˜ (í™•ì¸ ì—†ì´ ë°”ë¡œ ì‚­ì œ)
        async function deleteEvent(eventId) {
            try {
                console.log('ğŸ—‘ï¸ ì¼ì • ì‚­ì œ ì‹œì‘:', eventId);
                
                // ì‚­ì œí•  ì¼ì • ì°¾ê¸°
                const eventIndex = events.findIndex(e => e.id === eventId);
                if (eventIndex === -1) {
                    alert('ì‚­ì œí•  ì¼ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                const deletedEvent = events[eventIndex];
                console.log('ğŸ—‘ï¸ ì‚­ì œí•  ì¼ì •:', deletedEvent);
                
                // ë°°ì—´ì—ì„œ ì œê±°
                events.splice(eventIndex, 1);
                console.log('âœ… ì¼ì • ë°°ì—´ì—ì„œ ì œê±°ë¨. ë‚¨ì€ ì¼ì • ìˆ˜:', events.length);
                
                // ë°ì´í„° ì €ì¥
                await saveData();
                console.log('ğŸ’¾ ë°ì´í„° ì €ì¥ ì™„ë£Œ');
                
                // ìº˜ë¦°ë” ìƒˆë¡œê³ ì¹¨
                if (document.getElementById('schedulePage').classList.contains('active')) {
                    renderCalendar();
                }
                
                showSyncStatus(`"${deletedEvent.title}" ì‚­ì œë¨`, 'success');
                console.log('ğŸ‰ ì¼ì • ì‚­ì œ ì™„ë£Œ!');
                
            } catch (error) {
                console.error('âŒ ì¼ì • ì‚­ì œ ì¤‘ ì˜¤ë¥˜:', error);
                alert('ì¼ì • ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                showSyncStatus('ì¼ì • ì‚­ì œ ì‹¤íŒ¨', 'error');
            }
        }

        // ì¼ì • ìˆ˜ì • í•¨ìˆ˜
        function editEvent(eventId) {
            const event = events.find(e => e.id === eventId);
            if (!event) {
                alert('ìˆ˜ì •í•  ì¼ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            console.log('âœï¸ ì¼ì • ìˆ˜ì • ì‹œì‘:', event);
            
            // ì „ì—­ ë³€ìˆ˜ë¡œ í˜„ì¬ ìˆ˜ì • ì¤‘ì¸ ì¼ì • ID ì €ì¥
            window.editingEventId = eventId;
            
            // ì¼ì • ëª¨ë‹¬ì„ ìˆ˜ì • ëª¨ë“œë¡œ ì—´ê¸°
            document.getElementById('eventModal').classList.add('active');
            
            // ëª¨ë‹¬ ì œëª© ë³€ê²½
            document.querySelector('#eventModal .modal-title').textContent = 'ì¼ì • ìˆ˜ì •';
            document.getElementById('eventSubmitBtn').textContent = 'ìˆ˜ì • ì™„ë£Œ';
            
            // ê¸°ì¡´ ë°ì´í„°ë¥¼ í¼ì— ì±„ìš°ê¸°
            document.getElementById('eventTitle').value = event.title;
            document.getElementById('eventDate').value = event.date;
            document.getElementById('eventCategory').value = event.category;
            document.getElementById('eventDescription').value = event.description || '';
            
            clearEventFormErrors();
        }

        // ì¼ì • ì¶”ê°€ ëª¨ë‹¬
        function openEventModal() {
            document.getElementById('eventModal').classList.add('active');
            document.getElementById('eventDate').value = new Date().toISOString().split('T')[0];
            clearEventFormErrors();
        }

        function closeEventModal() {
            document.getElementById('eventModal').classList.remove('active');
            clearEventFormErrors();
            
            // ìˆ˜ì • ëª¨ë“œ í•´ì œ
            window.editingEventId = null;
            document.querySelector('#eventModal .modal-title').textContent = 'ì¼ì • ì¶”ê°€';
            document.getElementById('eventSubmitBtn').textContent = 'ì¶”ê°€';
        }

        // ì¼ì • ì¶”ê°€/ìˆ˜ì • ì§ì ‘ ì²˜ë¦¬ í•¨ìˆ˜
        async function handleEventSubmit() {
            const isEditMode = window.editingEventId != null;
            console.log(isEditMode ? 'âœï¸ ì¼ì • ìˆ˜ì • ì œì¶œ ì‹œì‘...' : 'ğŸš€ ì¼ì • ì¶”ê°€ ì œì¶œ ì‹œì‘...');
            
            try {
                // í¼ ìš”ì†Œë“¤ ì§ì ‘ í™•ì¸
                const titleEl = document.getElementById('eventTitle');
                const dateEl = document.getElementById('eventDate');
                const categoryEl = document.getElementById('eventCategory');
                const descEl = document.getElementById('eventDescription');
                
                if (!titleEl || !dateEl || !categoryEl) {
                    console.error('âŒ í•„ìˆ˜ í¼ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                    alert('í¼ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                const title = titleEl.value.trim();
                const date = dateEl.value;
                const category = categoryEl.value;
                const description = descEl ? descEl.value.trim() : '';
                
                console.log('ğŸ“‹ ì…ë ¥ëœ ê°’ë“¤:', {
                    title: `"${title}"`,
                    date: `"${date}"`,
                    category: `"${category}"`,
                    description: `"${description}"`,
                    isEditMode: isEditMode
                });
                
                // í•„ìˆ˜ í•„ë“œ ê²€ì¦
                if (!title) {
                    alert('ì¼ì • ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    titleEl.focus();
                    return;
                }
                
                if (!date) {
                    alert('ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    dateEl.focus();
                    return;
                }
                
                if (!category) {
                    alert('ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    categoryEl.focus();
                    return;
                }
                
                console.log('âœ… ìœ íš¨ì„± ê²€ì‚¬ í†µê³¼');
                
                if (isEditMode) {
                    // ìˆ˜ì • ëª¨ë“œ
                    const eventIndex = events.findIndex(e => e.id === window.editingEventId);
                    if (eventIndex === -1) {
                        alert('ìˆ˜ì •í•  ì¼ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    const existingEvent = events[eventIndex];
                    console.log('ğŸ“ ê¸°ì¡´ ì¼ì •:', existingEvent);
                    
                    // ê¸°ì¡´ ì¼ì • ì—…ë°ì´íŠ¸
                    events[eventIndex] = {
                        ...existingEvent,
                        title: title,
                        date: date,
                        category: category,
                        description: description
                    };
                    
                    console.log('âœï¸ ì¼ì • ìˆ˜ì • ì™„ë£Œ:', events[eventIndex]);
                    showSyncStatus('ì¼ì • ìˆ˜ì • ì¤‘...', 'success');
                    
                } else {
                    // ìƒˆ ì¼ì • ì¶”ê°€ ëª¨ë“œ
                    const newEvent = {
                        id: Date.now(),
                        title: title,
                        date: date,
                        category: category,
                        description: description
                    };
                    
                    console.log('ğŸ†• ìƒˆ ì´ë²¤íŠ¸ ìƒì„±:', newEvent);
                    events.push(newEvent);
                    showSyncStatus('ì¼ì • ì €ì¥ ì¤‘...', 'success');
                }
                
                console.log('ğŸ“Š í˜„ì¬ ì´ë²¤íŠ¸ ìˆ˜:', events.length);
                
                // ë°ì´í„° ì €ì¥
                await saveData();
                console.log('ğŸ’¾ ë°ì´í„° ì €ì¥ ì™„ë£Œ');
                
                // ëª¨ë‹¬ ë‹«ê¸°
                closeEventModal();
                
                // ìº˜ë¦°ë” ìƒˆë¡œê³ ì¹¨
                if (document.getElementById('schedulePage').classList.contains('active')) {
                    console.log('ğŸ“… ìº˜ë¦°ë” ë‹¤ì‹œ ë Œë”ë§');
                    renderCalendar();
                }
                
                // ì„±ê³µ ë©”ì‹œì§€
                const action = isEditMode ? 'ìˆ˜ì •' : 'ì¶”ê°€';
                showSyncStatus(`ì¼ì •ì´ ${action}ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“…`, 'success');
                
                setTimeout(() => {
                    alert(`"${title}" ì¼ì •ì´ ì„±ê³µì ìœ¼ë¡œ ${action}ë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ ${events.length}ê°œì˜ ì¼ì •ì´ ìˆìŠµë‹ˆë‹¤. ğŸ“…`);
                }, 500);
                
                // í¼ ë¦¬ì…‹
                document.getElementById('eventForm').reset();
                
                console.log(`ğŸ‰ ì¼ì • ${action} ì™„ë£Œ!`);
                
            } catch (error) {
                console.error('âŒ ì¼ì • ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error);
                alert('ì¼ì • ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                showSyncStatus('ì¼ì • ì²˜ë¦¬ ì‹¤íŒ¨', 'error');
            }
        }

        // ì´ˆê¸°í™”
        window.addEventListener('load', async function() {
            console.log('ğŸš€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘...');
            showSyncStatus('ë°ì´í„° ë¡œë“œ ì¤‘...', 'success');
            
            // ê¸°ì¡´ ë°ì´í„° ë¡œë“œ ì‹œë„
            const hasExistingData = await loadAllData();
            
            // ê¸°ì¡´ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ìƒ˜í”Œ ë°ì´í„° ìƒì„±
            if (!hasExistingData) {
                console.log('ğŸ“ ìƒˆ ì‚¬ìš©ì - ìƒ˜í”Œ ë°ì´í„° ìƒì„± ì¤‘...');
                initSampleData();
                await saveData(); // ìƒ˜í”Œ ë°ì´í„° ì €ì¥
                showSyncStatus('ì´ˆê¸° ë°ì´í„° ìƒì„±ë¨', 'success');
            } else {
                showSyncStatus('ê¸°ì¡´ ë°ì´í„° ë¡œë“œë¨', 'success');
            }
            
            // ì¤‘ìš”: ì—…ë¡œë“œ ê´€ë ¨ ì´ˆê¸°í™”
            console.log('ğŸ”§ ì—…ë¡œë“œ ê¸°ëŠ¥ ì´ˆê¸°í™” ì¤‘...');
            initFileUpload();
            initUploadForm();
            // initEventForm(); ì œê±° - ì§ì ‘ onclick ì‚¬ìš©
            
            // í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜
            navigateToPage('home');
            
            // ì‹¤ì‹œê°„ ë™ê¸°í™” ì‹œì‘
            db.startRealTimeSync();
            
            // ë””ë²„ê¹…ìš© ì „ì—­ í•¨ìˆ˜ ì¶”ê°€
            window.clearClassData = () => db.clearAllData();
            window.showClassData = () => {
                console.log('í˜„ì¬ ì €ì¥ëœ ë°ì´í„°:', {
                    materials: materials.length,
                    events: events.length,
                    comments: comments.length,
                    likes: likedMaterials.length
                });
            };
            window.testUpload = () => {
                console.log('ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸ ì‹œì‘...');
                openUploadModal();
            };
            window.debugUpload = () => {
                console.log('=== ì—…ë¡œë“œ ë””ë²„ê¹… ì •ë³´ ===');
                console.log('í¼ ìš”ì†Œ:', document.getElementById('uploadForm'));
                console.log('ì œì¶œ ë²„íŠ¼:', document.getElementById('uploadSubmitBtn'));
                console.log('ì„ íƒëœ íŒŒì¼:', selectedFiles);
                console.log('í˜„ì¬ ìë£Œ ìˆ˜:', materials.length);
                
                // í¼ ë°ì´í„° í™•ì¸
                const title = document.getElementById('materialTitle')?.value;
                const author = document.getElementById('materialAuthor')?.value;
                const subject = document.getElementById('materialSubject')?.value;
                console.log('í˜„ì¬ í¼ ë°ì´í„°:', { title, author, subject });
            };
            
            // ì¼ì • ë””ë²„ê¹… í•¨ìˆ˜ ì¶”ê°€
            window.debugEvent = () => {
                console.log('=== ì¼ì • ë””ë²„ê¹… ì •ë³´ ===');
                const form = document.getElementById('eventForm');
                const title = document.getElementById('eventTitle');
                const date = document.getElementById('eventDate');
                const category = document.getElementById('eventCategory');
                
                console.log('í¼ ìš”ì†Œ:', form);
                console.log('ì œëª© ìš”ì†Œ:', title);
                console.log('í˜„ì¬ ì…ë ¥ê°’ë“¤:', {
                    title: title?.value,
                    titleTrimmed: title?.value?.trim(),
                    date: date?.value,
                    category: category?.value
                });
                console.log('í˜„ì¬ ì´ë²¤íŠ¸ ìˆ˜:', events.length);
            };
            
            window.testEventAdd = () => {
                console.log('ì¼ì • ì¶”ê°€ ê°•ì œ í…ŒìŠ¤íŠ¸...');
                const testEvent = {
                    id: Date.now(),
                    title: 'í…ŒìŠ¤íŠ¸ ì¼ì •',
                    date: '2025-08-16',
                    category: 'school',
                    description: 'í…ŒìŠ¤íŠ¸ìš© ì¼ì •ì…ë‹ˆë‹¤'
                };
                events.push(testEvent);
                console.log('í…ŒìŠ¤íŠ¸ ì¼ì • ì¶”ê°€ë¨:', testEvent);
                console.log('ì´ ì¼ì • ìˆ˜:', events.length);
                if (document.getElementById('schedulePage').classList.contains('active')) {
                    renderCalendar();
                }
            };
            
            window.testDelete = () => {
                console.log('=== ì‚­ì œ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ===');
                console.log('í˜„ì¬ ìë£Œ ìˆ˜:', materials.length);
                console.log('í˜„ì¬ ì¼ì • ìˆ˜:', events.length);
                console.log('ğŸ“š ìë£Œ ì‚­ì œ: ğŸ—‘ï¸ ë²„íŠ¼ í´ë¦­');
                console.log('ğŸ“… ì¼ì • ì‚­ì œ: ì¼ì •ì„ 0.8ì´ˆ ê¸¸ê²Œ ëˆ„ë¥¸ í›„ ğŸ—‘ï¸ ë²„íŠ¼ í´ë¦­');
                if (materials.length > 0) {
                    console.log('ì²« ë²ˆì§¸ ìë£Œ ID:', materials[0].id);
                }
                if (events.length > 0) {
                    console.log('ì²« ë²ˆì§¸ ì¼ì • ID:', events[0].id);
                }
            };
            
            console.log('âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ì™„ë£Œ');
            console.log('ğŸ’¡ ë¸Œë¼ìš°ì € ì½˜ì†” ëª…ë ¹ì–´:');
            console.log('   - clearClassData(): ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”');
            console.log('   - showClassData(): í˜„ì¬ ë°ì´í„° í™•ì¸'); 
            console.log('   - testUpload(): ì—…ë¡œë“œ ëª¨ë‹¬ í…ŒìŠ¤íŠ¸');
            console.log('   - debugUpload(): ì—…ë¡œë“œ ìƒíƒœ ë””ë²„ê¹…');
            console.log('   - testEventAdd(): í…ŒìŠ¤íŠ¸ ì¼ì • ì¶”ê°€');
            console.log('   - testDelete(): ì‚­ì œ ê¸°ëŠ¥ ì‚¬ìš©ë²• ì•ˆë‚´');
            console.log('');
            console.log('ğŸ¯ ì‚¬ìš©ë²•:');
            console.log('   ğŸ“š ìë£Œ ìˆ˜ì •: âœï¸ ë²„íŠ¼ í´ë¦­');
            console.log('   ğŸ“š ìë£Œ ì‚­ì œ: ğŸ—‘ï¸ ë²„íŠ¼ í´ë¦­');
            console.log('   ğŸ“… ì¼ì • ìˆ˜ì •: ì¼ì • í´ë¦­');
            console.log('   ğŸ“… ì¼ì • ì‚­ì œ: ì¼ì •ì„ ê¸¸ê²Œ ëˆ„ë¥¸ í›„ ğŸ—‘ï¸ ë²„íŠ¼ í´ë¦­');
        });
    </script>
</body>
</html>